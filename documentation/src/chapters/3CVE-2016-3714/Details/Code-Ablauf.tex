\subsection{Code-Ablauf}\label{subsec:code-ablauf}

\begin{lstlisting}[firstnumber=90, language=C, caption=utilities/convert.c Einstieg Main(),label={lst:lstlisting}]
int main(int argc,char **argv)
{
  return(ConvertMain(argc,argv));
}
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=67, language=C, caption=utilities/convert.c ConvertMain(),label={lst:lstlisting}]
static int ConvertMain(int argc,char **argv)
{
  ExceptionInfo
    *exception;

  ImageInfo
    *image_info;

  MagickBooleanType
    status;

  MagickCoreGenesis(*argv,MagickTrue);
  exception=AcquireExceptionInfo();
  image_info=AcquireImageInfo();
  status=MagickCommandGenesis(image_info,ConvertImageCommand,argc,argv,
    (char **) NULL,exception);
  image_info=DestroyImageInfo(image_info);
  exception=DestroyExceptionInfo(exception);
  MagickCoreTerminus();
  return(status != MagickFalse ? 0 : 1);
}
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=81, language=C, caption=utilities/convert.c Aufruf MagickCommandGenesis(),label={lst:lstlisting}]
  status=MagickCommandGenesis(image_info,ConvertImageCommand,argc,argv,
    (char **) NULL,exception);
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=498, language=C, caption=wand/convert.c ConvertImageCommand(),label={lst:lstlisting}]
WandExport MagickBooleanType ConvertImageCommand(ImageInfo *image_info,
  int argc,char **argv,char **metadata,ExceptionInfo *exception)
{
  ...
}
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=628, language=C, caption=wand/convert.c Aufruf ReadImages(),label={lst:lstlisting}]
  images=ReadImages(image_info,exception);
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=790, language=C, caption=magick/constitute.c ReadImages(),label={lst:lstlisting}]
MagickExport Image *ReadImages(const ImageInfo *image_info,
  ExceptionInfo *exception)
{
  ...
}
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=352, language=C, caption=magick/constitute.c ReadImage(),label={lst:lstlisting}]
MagickExport Image *ReadImage(const ImageInfo *image_info,
  ExceptionInfo *exception)
{
  ...
}
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=523, language=C, caption=magick/constitue.c Aufruf InvokeDelegate(),label={lst:lstlisting}]
  (void) InvokeDelegate(read_info,image,read_info->magick,(char *) NULL,
    exception);
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=1097, language=C, caption=magick/delegate.c InvokeDelegate(),label={lst:lstlisting}]
MagickExport MagickBooleanType InvokeDelegate(ImageInfo *image_info,
  Image *image,const char *decode,const char *encode,ExceptionInfo *exception)
{
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=1301, language=C, caption=magick/delegate.c Aufruf ExternalDelegateCommand(),label={lst:lstlisting}]
  status=ExternalDelegateCommand(delegate_info->spawn,image_info->verbose,
    command,(char *) NULL,exception) != 0 ? MagickTrue : MagickFalse;
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=346, language=C, caption=magick/delegate.c ExternalDelegateCommand(),label={lst:lstlisting}]
MagickExport int ExternalDelegateCommand(const MagickBooleanType asynchronous,
  const MagickBooleanType verbose,const char *command,char *message,
  ExceptionInfo *exception)
{
  ...
}
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=395, language=C, caption=magick/delegate.c Aufruf SanitizeDelegateCommand(),label={lst:lstlisting}]
  sanitize_command=SanitizeDelegateCommand(command);
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=322, language=C, caption=magick/delegate.c SanitizieDelegateCommand(),label={lst:lstlisting}]
static char *SanitizeDelegateCommand(const char *command)
{
  char
    *sanitize_command;

  const char
    *q;

  register char
    *p;

  static char
    whitelist[] =
      "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_- "
      ".@&;<>()|/\\\'\":%=~`";

  sanitize_command=AcquireString(command);
  p=sanitize_command;
  q=sanitize_command+strlen(sanitize_command);
  for (p+=strspn(p,whitelist); p != q; p+=strspn(p,whitelist))
    *p='_';
  return(sanitize_command);
}
\end{lstlisting}
\vspace{5mm}

\begin{lstlisting}[firstnumber=402, language=C, caption=magick/delegate.c Aufruf system(),label={lst:lstlisting}]
  status=system(sanitize_command);
\end{lstlisting}
\vspace{5mm}
